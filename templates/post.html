{% extends 'base.html' %}
{% load markdown_extras %}
{% block content %}

<body class="bg-gray-100 font-sans leading-normal tracking-normal"> 

	

	<!--Container-->
	<div class="container w-full md:max-w-3xl mx-auto pt-20">

		<div class="w-full px-4 md:px-6 text-xl text-gray-800 leading-normal" style="font-family:Georgia,serif;">

			<!--Title-->
			<div class="font-sans">
				<h1 class="font-bold font-sans break-normal text-gray-900 pt-6 pb-2 text-3xl md:text-4xl">
				{{ post.title }}</h1>
				<p class="text-sm md:text-base font-normal text-gray-600">
				{{ post.timestamp}}</p>
				<img class="h-40 rounded w-full object-cover object-center mb-6" src="{{ post.thumbnail.url }}" alt="content">
			</div>

			<!--Post Content-->
			<div class="py-6">
				{{ post.content | markdown | safe }}
			</div>

			<ol>
				<li class="py-3">Maecenas accumsan lacus sit amet elementum porta. Aliquam eu libero lectus...</li>
				<li class="py-3">Morbi varius posuere blandit. Praesent gravida bibendum neque eget commodo...</li>
				<li class="py-3">Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae...</li>
			</ol>

		</div>

		<!--Divider-->
		<hr class="border-b-2 border-gray-400 mb-8 mx-4">

		<!--Author-->
		<div class="flex w-full items-center font-sans px-4 py-12">
			<img class="w-10 h-10 rounded-full mr-4" src="{{ post.author.profile_picture.url }}">
			<div class="flex-1 px-2">
				<p class="text-base font-bold text-base md:text-xl leading-none mb-2">
				{{ post.author }}</p>
			</div>
		</div>
		<!--/Author-->

		<!--Divider-->
</body>
{% csrf_token %}

<button id="like-btn" type="button">
    ‚ù§Ô∏è Like (<span id="like-count">{{ post.likes.count }}</span>)
</button>

<script>
document.getElementById("like-btn").addEventListener("click", function () {
    fetch("{% url 'like_post' post.slug %}", {   // üëà BURA √áOX VACƒ∞B
        method: "POST",
        headers: {
            "X-CSRFToken": "{{ csrf_token }}",
        },
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById("like-count").innerText = data.total_likes;

        if (data.liked) {
            this.innerHTML = "üíî Unlike (<span id='like-count'>" + data.total_likes + "</span>)";
        } else {
            this.innerHTML = "‚ù§Ô∏è Like (<span id='like-count'>" + data.total_likes + "</span>)";
        }
    });
});
</script>

	
	</div>
	<!--/container-->




{% endblock content %}


